<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-styles/typography.html">
<dom-module id="register-page-element">
    <template>
        <style is="custom-style" include="forms"></style>
        <style is="custom-style" include="login-and-register"></style>
        <style include="shared-styles">
        :host {
            display: block;
        }
        </style>
        <div class="centering-parent">
            <paper-material>
                <h2>Register</h2>
                <div class="form-content">
                    <paper-input id="name" label="Name" required error-message="Please enter your name" value="{{user.name}}"></paper-input>
                    <paper-input id="email" type="email" label="Email" required error-message="Please enter a valid email address" value="{{user.email}}"></paper-input>
                </div>
                <div class="bottom-actions">
                    <paper-button disabled$="[[!formReady]]" raised on-tap="_submitForm">Submit</paper-button>
                </div>
            </paper-material>
        </div>
        <iron-ajax id="ajax" url="/account" method="POST" on-request="_ajaxRequest" on-response="_ajaxResponse"></iron-ajax>
    </template>
    <script>
    (function() {
        'use strict';

        Polymer({
            is: 'register-page-element',

            properties: {
                user: {
                    type: Object,
                    value: function() {
                        return {
                            name: '',
                            email: ''
                        }
                    },
                    notify: true
                },
                sendingData: {
                    type: Boolean,
                    value: false
                },
                formReady: {
                    type: Boolean,
                    computed: '_computeFormReady(user.name, user.email, sendingData)'
                }
            },
            ready: function() {

            },
            _computeFormReady: function(name, email, sendingData) {
                var formReady = false;

                if (name && email) {
                    formReady = true;
                }

                if (sendingData) {
                    formReady = false;
                }

                return formReady;
            },
            _submitForm: function(e) {

            },
            _formReset: function() {
                this.set('user.name', '');
                this.set('user.email', '');
                this.$.name.invalid = false;
                this.$.email.invalid = false;
            },
            _ajaxRequest: function() {
                this.set('sendingData', true);
            },
            _ajaxResponse: function() {
                this.set('sendingData', false);
                this._formReset();
            }
        });
    })();
    </script>
</dom-module>
