<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-styles/typography.html">

<dom-module id="plan-element">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
      }

      iron-form paper-button {
        margin: 20px 0 0;
      }

      paper-card {
        display: block;
        width: 25%;
        float: left;
        text-align: center;
      }

      iron-form paper-dropdown-menu {
        display: block;
      }

      paper-button {
        display: block;
        margin: 0;
      }

      hr {
        border: none;
        border-bottom: 1px solid #ccc;
      }
    </style>

    <paper-card>
      <div class="card-content">
        <h4>[[plan.title]]</h4>
        <hr>
        <p>[[priceText]]</p>
        <p>[[plan.description]]</p>
        <paper-button raised on-tap="_selectPlan" plan="[[plan]]">Select</paper-button>
      </div>
    </paper-card>
  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'plan-element',

        properties: {
          plan: {
            type: Object
          },
          priceText: {
            type: String,
            computed: '_computePriceText(plan.price)'
          },
          discountedPriceText: {
            type: String,
            computed: '_computeDiscountedPriceText(plan.promo)'
          },
          expirationDate: {
            type: String,
            computed: '_computeExpirationDate(plan.expiration)'
          },
        },
        ready: function() {

        },
        _computePriceText: function(price) {
          return price != null ? '$' + price + '/month' : '';
        },
        _computeDiscountedPriceText: function(plan.promo) {
          if (this.plan.promo) {
            var newPrice = Math.round(this.plan.price * (1 - (this.plan.promo.discount / 100)));
            return '$' + newPrice + '/month';
          }
          return '';
        },
        _computeExpirationDate: function(expiration) {
          if (this.plan.expiration) {
            var d = new Date(this.plan.expiration * 1000);
            return d.getMonthName() + " " + d.getDate() + ", " + d.getFullYear();
          }
          return '';
        },
        _selectPlan: function(e) {
          var plan = e.currentTarget.plan;
          console.log(plan);
        }
      });
    })();
  </script>
</dom-module>
